<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CVE-2024-3566 (BatBadBut) - –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #d32f2f;
            text-align: center;
            border-bottom: 3px solid #d32f2f;
            padding-bottom: 10px;
        }
        h2 {
            color: #1976d2;
            margin-top: 30px;
        }
        .warning {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            padding: 15px;
            margin: 20px 0;
            color: #856404;
        }
        .example {
            background-color: #f8f9fa;
            border-left: 4px solid #007bff;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 5px 5px 0;
        }
        .vulnerable {
            border-left-color: #dc3545;
            background-color: #f8d7da;
        }
        .safe {
            border-left-color: #28a745;
            background-color: #d4edda;
        }
        pre {
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 10px 0;
        }
        .demo-section {
            margin: 30px 0;
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
        }
        input[type="text"] {
            width: 70%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        button {
            padding: 10px 20px;
            margin-left: 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        .btn-danger {
            background-color: #dc3545;
            color: white;
        }
        .btn-success {
            background-color: #28a745;
            color: white;
        }
        .btn-info {
            background-color: #17a2b8;
            color: white;
        }
        .result {
            margin-top: 15px;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
        }
        .result.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .result.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .result.warning {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .payload-examples {
            margin: 20px 0;
        }
        .payload-item {
            margin: 10px 0;
            padding: 10px;
            background-color: #f1f3f4;
            border-radius: 4px;
            cursor: pointer;
            border: 1px solid #ddd;
        }
        .payload-item:hover {
            background-color: #e8f0fe;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        .stat-number {
            font-size: 2em;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üõ°Ô∏è CVE-2024-3566 (BatBadBut) - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è</h1>
        
        <div class="warning">
            <strong>‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï:</strong> –≠—Ç–æ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–∏ CVE-2024-3566. 
            –í—Å–µ –ø—Ä–∏–º–µ—Ä—ã –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –º–µ—Ç–æ–¥–æ–≤ –∑–∞—â–∏—Ç—ã.
        </div>

        <div class="stats">
            <div class="stat-card">
                <div class="stat-number">2024</div>
                <div>–ì–æ–¥ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">9.8</div>
                <div>CVSS Score</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">5+</div>
                <div>–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã—Ö —è–∑—ã–∫–æ–≤</div>
            </div>
        </div>

        <h2>üìñ –û–ø–∏—Å–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏</h2>
        <p>CVE-2024-3566 (BatBadBut) - —ç—Ç–æ —É—è–∑–≤–∏–º–æ—Å—Ç—å –∫–æ–º–∞–Ω–¥–Ω–æ–π –∏–Ω—ä–µ–∫—Ü–∏–∏ –≤ Windows-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –ø—Ä–∏:</p>
        <ul>
            <li>–í—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥ –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è <code>.exe</code></li>
            <li>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–º –ø–æ–∏—Å–∫–µ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ batch-—Ñ–∞–π–ª–æ–≤ Windows</li>
            <li>–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–º —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏</li>
        </ul>

        <h2>üîç –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è</h2>
        
        <div class="demo-section">
            <h3>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</h3>
            <p>–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –∏–ª–∏ –∞—Ä–≥—É–º–µ–Ω—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤:</p>
            
            <div class="warning" style="margin: 10px 0; font-size: 14px;">
                <strong>üí° –≠—Ç–æ —Å–∏–º—É–ª—è—Ç–æ—Ä!</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è. 
                –ù–ï –≤—ã–ø–æ–ª–Ω—è–π—Ç–µ –ø–æ–∫–∞–∑–∞–Ω–Ω—ã–π –∫–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞!
            </div>
            
            <input type="text" id="userInput" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: package&quot; &amp;&amp; calc.exe &amp;&amp; echo &quot;" />
            <button class="btn-info" onclick="validateInput()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
            <button class="btn-success" onclick="escapeInput()">–≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞—Ç—å</button>
            
            <div id="validationResult" class="result" style="display: none;"></div>
            
            <div class="payload-examples">
                <h4>–ü—Ä–∏–º–µ—Ä—ã –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö payload'–æ–≤ (–∫–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏):</h4>
                <div class="payload-item" onclick="setInput('package&quot; &amp;&amp; calc.exe &amp;&amp; echo &quot;')">
                    package" && calc.exe && echo "
                </div>
                <div class="payload-item" onclick="setInput('https://repo.git&quot; &amp;&amp; whoami &amp;&amp; echo &quot;')">
                    https://repo.git" && whoami && echo "
                </div>
                <div class="payload-item" onclick="setInput('normal-package-name')">
                    normal-package-name (–±–µ–∑–æ–ø–∞—Å–Ω—ã–π)
                </div>
                <div class="payload-item" onclick="setInput('--help; rm -rf /')">
                    --help; rm -rf / (–ø–æ–ø—ã—Ç–∫–∞ Linux –∫–æ–º–∞–Ω–¥—ã)
                </div>
            </div>
        </div>

        <h2>üíª –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞</h2>

        <div class="example vulnerable">
            <h3>‚ùå –£—è–∑–≤–∏–º—ã–π –∫–æ–¥ (Node.js)</h3>
            <pre><code>const { spawn } = require('child_process');

// –û–ü–ê–°–ù–û: –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è .exe
function executeCommand(userInput) {
    const child = spawn('npm', ['install', userInput]);
    // –ï—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç npm.bat, –º–æ–∂–µ—Ç –ø—Ä–æ–∏–∑–æ–π—Ç–∏ –∏–Ω—ä–µ–∫—Ü–∏—è!
}</code></pre>
        </div>

        <div class="example safe">
            <h3>‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫–æ–¥ (Node.js)</h3>
            <pre><code>const { spawn } = require('child_process');

// –ë–ï–ó–û–ü–ê–°–ù–û: —è–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ .exe
function executeCommand(userInput) {
    // –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    if (!/^[a-zA-Z0-9\-_.@/]+$/.test(userInput)) {
        throw new Error('–ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–µ —Å–∏–º–≤–æ–ª—ã');
    }
    
    const child = spawn('npm.exe', ['install', userInput]);
}</code></pre>
        </div>

        <div class="example vulnerable">
            <h3>‚ùå –£—è–∑–≤–∏–º—ã–π –∫–æ–¥ (Python)</h3>
            <pre><code>import subprocess

# –û–ü–ê–°–ù–û: –±–µ–∑ .exe –∏ shell=True
def run_git_command(user_input):
    subprocess.run(f"git clone {user_input}", shell=True)
    # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –æ–ø–∞—Å–Ω–æ!</code></pre>
        </div>

        <div class="example safe">
            <h3>‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫–æ–¥ (Python)</h3>
            <pre><code>import subprocess
import shlex

# –ë–ï–ó–û–ü–ê–°–ù–û: –±–µ–∑ shell=True –∏ —Å —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º
def run_git_command(user_input):
    # –í–∞–ª–∏–¥–∞—Ü–∏—è
    if not user_input.startswith('https://'):
        raise ValueError('–¢–æ–ª—å–∫–æ HTTPS URL —Ä–∞–∑—Ä–µ—à–µ–Ω—ã')
    
    # –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —è–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ .exe
    subprocess.run(['git.exe', 'clone', user_input])</code></pre>
        </div>

        <h2>üõ†Ô∏è –ú–µ—Ç–æ–¥—ã –∑–∞—â–∏—Ç—ã</h2>
        
        <div class="example safe">
            <h3>1. –Ø–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è .exe</h3>
            <pre><code>// –í–º–µ—Å—Ç–æ: spawn('git', ...)
spawn('git.exe', ...)

# –í–º–µ—Å—Ç–æ: subprocess.run(['npm', ...])
subprocess.run(['npm.exe', ...])</code></pre>
        </div>

        <div class="example safe">
            <h3>2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–±—Å–æ–ª—é—Ç–Ω—ã—Ö –ø—É—Ç–µ–π</h3>
            <pre><code>// Node.js
const gitPath = 'C:\\Program Files\\Git\\bin\\git.exe';
spawn(gitPath, ['clone', userInput]);

# Python
git_path = r'C:\Program Files\Git\bin\git.exe'
subprocess.run([git_path, 'clone', user_input])</code></pre>
        </div>

        <div class="example safe">
            <h3>3. –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>
            <pre><code>// Node.js - –≤–∞–ª–∏–¥–∞—Ü–∏—è
function validateInput(input) {
    const dangerousChars = /[&|;`$(){}[\]<>]/;
    if (dangerousChars.test(input)) {
        throw new Error('–û–ø–∞—Å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã');
    }
}

# Python - —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
import shlex
escaped_input = shlex.quote(user_input)</code></pre>
        </div>

        <h2>üìä –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</h2>
        <ul>
            <li><strong>Node.js:</strong> –¥–æ –≤–µ—Ä—Å–∏–π 18.20.1, 20.12.1, 22.0.0</li>
            <li><strong>Python:</strong> –≤—Å–µ –≤–µ—Ä—Å–∏–∏ (—Ç—Ä–µ–±—É–µ—Ç —Ä—É—á–Ω—ã—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π)</li>
            <li><strong>PHP:</strong> –≤—Å–µ –≤–µ—Ä—Å–∏–∏ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ exec(), system()</li>
            <li><strong>Rust:</strong> std::process::Command</li>
            <li><strong>Haskell:</strong> System.Process</li>
            <li><strong>Go:</strong> os/exec –ø–∞–∫–µ—Ç</li>
        </ul>

        <h2>üîó –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã</h2>
        <ul>
            <li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-3566" target="_blank">CVE-2024-3566 –≤ NVD</a></li>
            <li><a href="https://flatt.tech/research/posts/batbadbut-you-cant-securely-execute-commands-on-windows/" target="_blank">–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ Flatt Tech</a></li>
            <li><a href="https://www.kb.cert.org/vuls/id/123335" target="_blank">CERT/CC Advisory</a></li>
        </ul>
    </div>

    <script>
        function setInput(value) {
            document.getElementById('userInput').value = value;
        }

        function validateInput() {
            const input = document.getElementById('userInput').value;
            const resultDiv = document.getElementById('validationResult');
            
            if (!input) {
                showResult('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏', 'warning');
                return;
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ–ø–∞—Å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã
            const dangerousChars = /[&|;`$(){}[\]<>]/;
            const hasQuotes = /["']/;
            const hasShellOperators = /(\|\||&&|;|`)/;
            
            let issues = [];
            let severity = 'success';

            if (dangerousChars.test(input)) {
                issues.push('‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –æ–ø–∞—Å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã: ' + input.match(dangerousChars).join(', '));
                severity = 'error';
            }

            if (hasQuotes.test(input)) {
                issues.push('‚ö†Ô∏è  –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∫–∞–≤—ã—á–∫–∏ - –≤–æ–∑–º–æ–∂–Ω–∞ –∏–Ω—ä–µ–∫—Ü–∏—è');
                if (severity !== 'error') severity = 'warning';
            }

            if (hasShellOperators.test(input)) {
                issues.push('üö® –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã shell - –≤—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫!');
                severity = 'error';
            }

            if (issues.length === 0) {
                showResult('‚úÖ –í–≤–æ–¥ –≤—ã–≥–ª—è–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω—ã–º', 'success');
            } else {
                showResult('–ü–†–û–ë–õ–ï–ú–´ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò:\n' + issues.join('\n'), severity);
            }
        }

        function escapeInput() {
            const input = document.getElementById('userInput').value;
            const resultDiv = document.getElementById('validationResult');
            
            if (!input) {
                showResult('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è', 'warning');
                return;
            }

            // –ü—Ä–æ—Å—Ç–æ–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
            const windowsEscaped = '"' + input.replace(/"/g, '""') + '"';
            const unixEscaped = "'" + input.replace(/'/g, "'\"'\"'") + "'";
            
            showResult(
                `üìù –ü–†–ò–ú–ï–†–´ –≠–ö–†–ê–ù–ò–†–û–í–ê–ù–ò–Ø (–Ω–µ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è!):\n\n` +
                `–ò—Å—Ö–æ–¥–Ω—ã–π –≤–≤–æ–¥: ${input}\n\n` +
                `Windows CMD —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ: ${windowsEscaped}\n\n` +
                `Unix shell —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ: ${unixEscaped}\n\n` +
                `‚ö†Ô∏è –≠—Ç–æ –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è, –Ω–µ –≤—ã–ø–æ–ª–Ω—è–π—Ç–µ –∏—Ö –≤ –∫–æ–Ω—Å–æ–ª–∏!`, 
                'success'
            );
        }

        function showResult(message, type) {
            const resultDiv = document.getElementById('validationResult');
            resultDiv.textContent = message;
            resultDiv.className = `result ${type}`;
            resultDiv.style.display = 'block';
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –≤–≤–æ–¥–µ
        document.getElementById('userInput').addEventListener('input', function() {
            const input = this.value;
            if (input.length > 0) {
                // –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
                const dangerousChars = /[&|;`$(){}[\]<>]/;
                if (dangerousChars.test(input)) {
                    this.style.borderColor = '#dc3545';
                    this.style.backgroundColor = '#f8d7da';
                } else {
                    this.style.borderColor = '#28a745';
                    this.style.backgroundColor = '#d4edda';
                }
            } else {
                this.style.borderColor = '#ddd';
                this.style.backgroundColor = 'white';
            }
        });
    </script>
</body>
</html>